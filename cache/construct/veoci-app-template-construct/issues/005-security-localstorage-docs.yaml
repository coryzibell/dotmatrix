metadata:
  title: Document localStorage JWT security tradeoff
  type: issue
  labels:
  - identity:morpheus
  - security
  - documentation
  assignees: []
  milestone: null
  github_issue_number: 5
  last_synced:
    title: Document localStorage JWT security tradeoff
    body: "# Document localStorage JWT security tradeoff\n\n\n\n\n\n\nFrom Construct\
      \ review of `veoci-app-template-construct`. Cypher flagged localStorage usage;\
      \ Spoon reframed as documentation issue rather than code change.\n\n**Sources:**\n\
      - `~/.claude/cache/construct/veoci-app-template-construct/security-findings.md`\n\
      - `~/.claude/cache/construct/veoci-app-template-construct/perspective-spoon.md`\n\
      \n## Problem\n\nThe auth store uses localStorage for JWT tokens:\n```typescript\n\
      authToken: localStorage.getItem('authToken'),\n```\n\nThis is vulnerable to\
      \ XSS attacks but may be the correct choice if:\n- Veoci API doesn't support\
      \ httpOnly cookies\n- The template has no control over backend auth mechanism\n\
      \n**The issue isn't the code - it's the lack of documentation explaining the\
      \ tradeoff.**\n\nDevelopers using this template don't know:\n- Why localStorage\
      \ was chosen\n- What the security implications are\n- How to migrate to httpOnly\
      \ cookies if their deployment supports it\n\n## Solution\n\nAdd documentation\
      \ explaining the security model and migration path.\n\n## Implementation Steps\n\
      \n1. Add comment block in `src/store/auth.ts`:\n   ```typescript\n   /**\n \
      \   * SECURITY NOTE: Token Storage\n    *\n    * This template stores JWT tokens\
      \ in localStorage for simplicity.\n    *\n    * TRADEOFFS:\n    * - Pros: Works\
      \ across tabs, survives page refresh, no backend changes needed\n    * - Cons:\
      \ Vulnerable to XSS attacks (any injected script can steal tokens)\n    *\n\
      \    * FOR PRODUCTION APPS:\n    * If your Veoci deployment supports httpOnly\
      \ cookies, migrate token storage:\n    * 1. Configure backend to set httpOnly,\
      \ Secure, SameSite=Strict cookies\n    * 2. Remove localStorage token storage\n\
      \    * 3. Let browser handle token transmission automatically\n    *\n    *\
      \ See: docs/security/token-storage.md for migration guide\n    */\n   ```\n\n\
      2. Create `docs/security/token-storage.md` with:\n   - Current implementation\
      \ explanation\n   - XSS risk assessment\n   - httpOnly cookie migration steps\n\
      \   - CSP recommendations for XSS mitigation\n\n3. Add security section to README\
      \ linking to docs\n\n## Acceptance Criteria\n\n- [ ] Auth store has clear security\
      \ comment\n- [ ] Security documentation exists\n- [ ] README links to security\
      \ docs\n- [ ] Developers understand tradeoff before shipping to production\n\
      \n## Handoff\n\nMorpheus writes documentation. Cypher reviews for accuracy."
    labels:
    - documentation
    - identity:morpheus
    - security
    github_updated_at: '2025-11-27T00:29:54Z'
    assignees: []
body_markdown: "# Document localStorage JWT security tradeoff\n\n\n\n\n\n\nFrom Construct\
  \ review of `veoci-app-template-construct`. Cypher flagged localStorage usage; Spoon\
  \ reframed as documentation issue rather than code change.\n\n**Sources:**\n- `~/.claude/cache/construct/veoci-app-template-construct/security-findings.md`\n\
  - `~/.claude/cache/construct/veoci-app-template-construct/perspective-spoon.md`\n\
  \n## Problem\n\nThe auth store uses localStorage for JWT tokens:\n```typescript\n\
  authToken: localStorage.getItem('authToken'),\n```\n\nThis is vulnerable to XSS\
  \ attacks but may be the correct choice if:\n- Veoci API doesn't support httpOnly\
  \ cookies\n- The template has no control over backend auth mechanism\n\n**The issue\
  \ isn't the code - it's the lack of documentation explaining the tradeoff.**\n\n\
  Developers using this template don't know:\n- Why localStorage was chosen\n- What\
  \ the security implications are\n- How to migrate to httpOnly cookies if their deployment\
  \ supports it\n\n## Solution\n\nAdd documentation explaining the security model\
  \ and migration path.\n\n## Implementation Steps\n\n1. Add comment block in `src/store/auth.ts`:\n\
  \   ```typescript\n   /**\n    * SECURITY NOTE: Token Storage\n    *\n    * This\
  \ template stores JWT tokens in localStorage for simplicity.\n    *\n    * TRADEOFFS:\n\
  \    * - Pros: Works across tabs, survives page refresh, no backend changes needed\n\
  \    * - Cons: Vulnerable to XSS attacks (any injected script can steal tokens)\n\
  \    *\n    * FOR PRODUCTION APPS:\n    * If your Veoci deployment supports httpOnly\
  \ cookies, migrate token storage:\n    * 1. Configure backend to set httpOnly, Secure,\
  \ SameSite=Strict cookies\n    * 2. Remove localStorage token storage\n    * 3.\
  \ Let browser handle token transmission automatically\n    *\n    * See: docs/security/token-storage.md\
  \ for migration guide\n    */\n   ```\n\n2. Create `docs/security/token-storage.md`\
  \ with:\n   - Current implementation explanation\n   - XSS risk assessment\n   -\
  \ httpOnly cookie migration steps\n   - CSP recommendations for XSS mitigation\n\
  \n3. Add security section to README linking to docs\n\n## Acceptance Criteria\n\n\
  - [ ] Auth store has clear security comment\n- [ ] Security documentation exists\n\
  - [ ] README links to security docs\n- [ ] Developers understand tradeoff before\
  \ shipping to production\n\n## Handoff\n\nMorpheus writes documentation. Cypher\
  \ reviews for accuracy."
