metadata:
  title: Add security comment for client-side JWT decode
  type: issue
  labels:
  - identity:smith
  - security
  - P2
  assignees: []
  milestone: null
  github_issue_number: 6
  last_synced:
    title: Add security comment for client-side JWT decode
    body: "# Add security comment for client-side JWT decode\n\n\n\n\n\n\nFrom Construct\
      \ review of `veoci-app-template-construct`. Cypher flagged during security audit.\n\
      \n**Source:** `~/.claude/cache/construct/veoci-app-template-construct/security-findings.md`\n\
      \n## Problem\n\nThe auth store uses `jwt-decode` to extract claims from the\
      \ token:\n```typescript\nimport { jwtDecode } from 'jwt-decode'\n// ...\nconst\
      \ decoded = jwtDecode(token)\nthis.jwtClaims = decoded\n```\n\n`jwt-decode`\
      \ does **not validate signatures**. If these claims are used for authorization\
      \ decisions (e.g., hiding admin features), an attacker could forge tokens client-side.\n\
      \nThis is safe IF claims are only used for UI hints (display username, check\
      \ expiry). But developers may not realize the limitation.\n\n## Solution\n\n\
      Add explicit warning comment to prevent misuse.\n\n## Implementation Steps\n\
      \n1. Add comment above jwt-decode usage in `src/store/auth.ts`:\n   ```typescript\n\
      \   /**\n    * WARNING: Client-side JWT decode does NOT validate signatures!\n\
      \    *\n    * jwt-decode only parses the token payload - it does NOT verify\n\
      \    * the token is authentic or unmodified.\n    *\n    * USE ONLY FOR:\n \
      \   * - Displaying user info (name, email)\n    * - Checking token expiry for\
      \ refresh timing\n    * - UI hints (show/hide based on roles for UX, not security)\n\
      \    *\n    * DO NOT USE FOR:\n    * - Authorization decisions (server must\
      \ validate on every request)\n    * - Access control logic\n    * - Anything\
      \ security-critical\n    *\n    * The server MUST validate the JWT signature\
      \ on every API request.\n    */\n   const decoded = jwtDecode(token)\n   ```\n\
      \n2. Review `jwtClaims` usage to ensure it's not used for authorization:\n \
      \  ```bash\n   grep -r \"jwtClaims\" src/\n   ```\n\n3. If any authorization\
      \ logic found, refactor to server-side check\n\n## Acceptance Criteria\n\n-\
      \ [ ] Warning comment added above jwt-decode usage\n- [ ] Verified jwtClaims\
      \ not used for authorization logic\n- [ ] Any authorization-like usage documented\
      \ as \"UI hint only\"\n\n## Handoff\n\nSmith adds comment and reviews usage.\
      \ Cypher verifies no security issues remain."
    labels:
    - identity:smith
    - P2
    - security
    github_updated_at: '2025-11-27T00:29:54Z'
    assignees: []
body_markdown: "# Add security comment for client-side JWT decode\n\n\n\n\n\n\nFrom\
  \ Construct review of `veoci-app-template-construct`. Cypher flagged during security\
  \ audit.\n\n**Source:** `~/.claude/cache/construct/veoci-app-template-construct/security-findings.md`\n\
  \n## Problem\n\nThe auth store uses `jwt-decode` to extract claims from the token:\n\
  ```typescript\nimport { jwtDecode } from 'jwt-decode'\n// ...\nconst decoded = jwtDecode(token)\n\
  this.jwtClaims = decoded\n```\n\n`jwt-decode` does **not validate signatures**.\
  \ If these claims are used for authorization decisions (e.g., hiding admin features),\
  \ an attacker could forge tokens client-side.\n\nThis is safe IF claims are only\
  \ used for UI hints (display username, check expiry). But developers may not realize\
  \ the limitation.\n\n## Solution\n\nAdd explicit warning comment to prevent misuse.\n\
  \n## Implementation Steps\n\n1. Add comment above jwt-decode usage in `src/store/auth.ts`:\n\
  \   ```typescript\n   /**\n    * WARNING: Client-side JWT decode does NOT validate\
  \ signatures!\n    *\n    * jwt-decode only parses the token payload - it does NOT\
  \ verify\n    * the token is authentic or unmodified.\n    *\n    * USE ONLY FOR:\n\
  \    * - Displaying user info (name, email)\n    * - Checking token expiry for refresh\
  \ timing\n    * - UI hints (show/hide based on roles for UX, not security)\n   \
  \ *\n    * DO NOT USE FOR:\n    * - Authorization decisions (server must validate\
  \ on every request)\n    * - Access control logic\n    * - Anything security-critical\n\
  \    *\n    * The server MUST validate the JWT signature on every API request.\n\
  \    */\n   const decoded = jwtDecode(token)\n   ```\n\n2. Review `jwtClaims` usage\
  \ to ensure it's not used for authorization:\n   ```bash\n   grep -r \"jwtClaims\"\
  \ src/\n   ```\n\n3. If any authorization logic found, refactor to server-side check\n\
  \n## Acceptance Criteria\n\n- [ ] Warning comment added above jwt-decode usage\n\
  - [ ] Verified jwtClaims not used for authorization logic\n- [ ] Any authorization-like\
  \ usage documented as \"UI hint only\"\n\n## Handoff\n\nSmith adds comment and reviews\
  \ usage. Cypher verifies no security issues remain."
