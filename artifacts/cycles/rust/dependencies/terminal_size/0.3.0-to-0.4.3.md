# terminal_size: 0.3.0 → 0.4.3

**Released:** 0.4.0+ (2024-2025)
**Type:** MINOR (Breaking API)
**Risk:** LOW

## Breaking Changes

### 1. Function Deprecation (#66)

**Deprecated and now unsafe:**
- `terminal_size_using_fd()`
- `terminal_size_using_handle()`

**Migration:**
Use the safe `terminal_size()` function instead.

```rust
// Old (0.3)
let size = terminal_size_using_fd(fd);

// New (0.4+)
let size = terminal_size();
```

### 2. Behavior Change: terminal_size() Success Cases

**Important:** `terminal_size()` now returns success in **more cases** than before.

**Example:**
```bash
# Old behavior (0.3)
./app > output.txt  # terminal_size() returns None

# New behavior (0.4+)
./app > output.txt  # terminal_size() may return Some(size)
```

**Impact:** If your code assumed `terminal_size()` would return `None` when stdout is redirected, this may change behavior.

**Mitigation:** Check if stdin/stdout/stderr is a TTY explicitly if needed:
```rust
use std::io::IsTerminal;

if std::io::stdout().is_terminal() {
    let size = terminal_size();
}
```

### 3. MSRV Bumped to 1.63.0

**0.3.0:** Rust 1.48.0+
**0.4.0+:** Rust 1.63.0+

**base-d status:** Currently on Rust 1.91.1 ✅

### 4. Dependency Update: rustix 0.38

Updated to rustix 0.38 (will be updated further in 0.4.3 via transitive deps).

## Migration Checklist

- [ ] Verify Rust 1.63+ (already on 1.91.1)
- [ ] Replace `terminal_size_using_fd()` with `terminal_size()`
- [ ] Replace `terminal_size_using_handle()` with `terminal_size()`
- [ ] Review assumptions about when `terminal_size()` returns None
- [ ] Test with stdout redirected if behavior is critical
- [ ] Update version to 0.4.3

## base-d Usage

base-d uses terminal_size for terminal size detection.

**Expected Changes:**
- Check for `terminal_size_using_fd()` usage
- Update to standard `terminal_size()` if needed

**Action:** Update to 0.4.3, verify no deprecated functions used.

## References

- [terminal-size on GitHub](https://github.com/eminence/terminal-size)
- [Releases](https://github.com/eminence/terminal-size/releases)
- [terminal_size on crates.io](https://crates.io/crates/terminal_size)

---
**Cached:** 2025-11-29
**Sources:** [GitHub terminal-size](https://github.com/eminence/terminal-size/releases)
